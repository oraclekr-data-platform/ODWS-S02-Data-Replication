이번 실습에서는 오라클 Database인 ATP(Autonomous Transaction Processing)에서 MySQL로의 이기종 데이터베이스 동기화를 진행합니다. 소스 데이터베이스는 2번에서 생성해 둔 ATP를 그대로 활용합니다.

## 작업 절차
|위치|작업 내용|
|---------|-----------------|
|A. MySQL DB(타겟 데이터베이스)|Target MySQL 생성|
|B. OCI-GG |OCI-GG for MySQL 인스턴스 생성|
|                  |Connections 생성 및 할당|
|                  | 인증 정보 생성 (타겟쪽: OGG-MySQL) |
|                | 인증 정보 생성 (소스쪽: OGG-Oracle) |
|       | Extract 프로세스 생성 (OCI-GG for Oracle) : Distribution Path|
|       | Replicat 프로세스 생성 (OCI-GG for MySQL)|
|       | ATP -> MySQL 데이터 동기화 확인|


## A. MySQL DB(타겟 데이터베이스) 구성
### Target MySQL 생성
1. OCI 콘솔 내에서 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Databases > MySQL HeatWave > DB Systems를 클릭합니다.
2. ‘Create DB System’을 클릭한 후, 아래와 같이 설정을 입력합니다. 아래 이외의 설정 값들은 Default로 진행하겠습니다. 모두 입력하고, ’Create’버튼을 클릭하여 DB를 생성합니다.
```
Type: Development or testing
Compartment: 생성하고자 하는 컴파트먼트 선택
Name: TARGETMYSQL
HA: Standalone
Administrator Username: ADMIN (MySQL의 경우, 대소문자 구분을 하기 때문에 대소문자에 유의합니다.)
Password: WElcome123__
VCN: DemoVCN (미리 만들어 둔 VCN을 선택합니다.)
Subnet: Public Subnet
```

<img width="758" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/66bf5533-cce5-4108-8ae5-c5bbd507c4b4">

3. 정상적으로 Creation이 완료 되었으면, MySQL이 프로비저닝된 VCN내 Security List에서 3306 포트를 오픈합니다.

<img width="1498" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/d67ac83a-edee-48ab-bdcb-6ca42aa8a057">

<img width="978" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/462d9824-c21f-45d3-a404-d99f0f974427">

4. 해당 VCN 내에 MySQL 인스턴스 접속을 위한 Bastion 서버를 생성 후, MySQL Client를 설치합니다.
```
sudo yum install -y \ https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm 
sudo yum install -y mysql-shell
mysqlsh admin@mysql privateIP(MySQL DB페이지 > Connections 탭 > Private IP address에서 확인가능합니다):3306 –sql

create database ADMIN;
Use ADMIN;
Create table TEST(num int);

CREATE TABLE `ADMIN`.`livelabs` 
   (	`ID` DECIMAL(19,0) PRIMARY KEY, 
	`TITLE` TEXT, 
	`URL` TEXT, 
	`TYPE` TEXT, 
	`DESC` TEXT, 
	`DURATION` TEXT, 
	`PUBLISHED_TIME` TEXT, 
	`TITLE_KO` TEXT, 
	`DESC_KO` TEXT, 
	`DURATION_KO` TEXT, 
	`OCI_PRODUCTS` TEXT, 
	`KEY_PHRASE` TEXT
   );
commit;
```
<img width="563" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e3f8aba8-258d-4600-a6d6-e674ca9fd4d6">


## A. OCI-GG for MySQL 구성
### OCI-GG for MySQL 인스턴스 생성
1.  OCI 콘솔 내에서 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Oracle Databases > GoldenGate를 클릭합니다.
2. 화면 중간에 Create deployment 버튼을 클릭합니다.
3. 아래와 같이 정보를 입력합니다.
```
Name: OGG-MySQL
Compartment: 생성하고자 하는 컴파트먼트 선택
Type: Development or testing
Subnet: Public subnet
License type: BYOL / License included에서 선택
show advanced options > Enable GoldenGate console public access를 꼭!! 체크해 줍니다.
```

<img width="1116" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/92c9641e-4746-47bc-85a6-8afbebe36acc">

4. Next를 클릭합니다. 아래와 같이 정보를 입력 후, Create를 누릅니다.
```
Technology: MySQL
Version: 최신 정보 그대로 놔둡니다.
Instance Name: OGG-MySQL
Credential Store: GoldenGate
Administrator username: ggadmin
Password secret: 기존에 만들어두었던 Password Secret을 선택합니다. 
```
<img width="562" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/573903ca-5abc-4826-a390-350bec4b7ee6">

### OCI-GG Connections 생성 및 할당
1. OCI 콘솔 내에 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Oracle Database > Goldengate를 클릭합니다.
2. 좌측 리스트 메뉴에서 Connections를 클릭합니다.

 <img width="1495" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/46585e3b-3a14-4500-beb4-0e43a6c730df">

4. Create connection 버튼을 클릭합니다. 아래의 정보를 입력합니다.
```
Name: TargetMySQL
Compartment: OCI-GG생성한 동일 컴파트먼트 선택
Type: OCI MySQL HeatWave
```

5. Next 버튼을 클릭합니다. select database 버튼을 클릭하여, 소스 데이터베이스 정보를 선택하고 아래와 같이 정보를 입력합니다.
```
Database: 소스 데이터베이스 선택
Database username: ADMIN
User password: WElcome123__
```

<img width="741" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/41389ef6-a452-4b03-b535-52207a1aa432">

6. Create를 클릭합니다.

