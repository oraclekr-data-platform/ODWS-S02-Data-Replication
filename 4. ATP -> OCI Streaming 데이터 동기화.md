이번 실습에서는 오라클 Database인 ATP(Autonomous Transaction Processing)에서 OCI Streaming로의 데이터 동기화를 진행합니다. 소스 데이터베이스는 2번에서 생성해 둔 ATP를 그대로 활용합니다.

## 작업 절차
|위치|작업 내용|
|---------|-----------------|
|A. OCI Streaming|Target OCI Streaming 생성|
|                |OCI Streaming Credential 확인|
|B. OCI-GG |OCI-GG for Bigdata 인스턴스 생성|
|                  |Connections 생성 및 할당|
|                  | 인증 정보 생성 (타겟쪽: OGG-Bigdata) |
|                | 인증 정보 생성 (소스쪽: OGG-Oracle) |
|       | Extract 프로세스 생성 (OCI-GG for Oracle) : Distribution Path|
|       | Replicat 프로세스 생성 (OCI-GG for Bigdata)|
|       | ATP -> OCI Streaming 데이터 동기화 확인|


## A. OCI Streaming 구성
### OCI Streaming 생성
1. OCI 콘솔 내에서 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Analytics & AI > Messaging > Streaming을 클릭합니다.
2. ‘Create Stream’을 클릭한 후, 아래와 같이 설정을 입력합니다. 아래 이외의 설정 값들은 Default로 진행하겠습니다. 모두 입력하고, ’Create’버튼을 클릭하여 생성합니다.
```
Stream Name: TargetST
Compartment: 생성하고자 하는 컴파트먼트 선택
Auto-Create a default stream pool 선택
```
<img width="934" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/38430f34-f45a-460c-ba51-cf01444a15b5">

### OCI Streaming Credential 확인
1. 생성한 streaming이 위치하고 있는 stream pool details 페이지에 갑니다.

<img width="1094" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/a60beb4e-e859-4d2b-ae75-51a6f9efdee1">

2. 좌측 하단에 Kafka connection Settings를 클릭합니다. Username=” ” 사이의 값을 복사하여 메모장에 붙여 둡니다. (Streaming connection 생성시에 유저 네임입니다)

<img width="1498" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/5ca68578-8362-4f65-bb54-6911056f05f9">

3. 패스워드는 AUTH_TOKEN을 사용하기 때문에 유저페이지에서 생성 후 AUTH TOKEN 값 또한 저장해 둡니다. 

<img width="1504" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e1e394a2-3c18-4846-a130-34a618c0f3ca">

## B. OCI-GG for Bigdata 구성
### OCI-GG for Bigdata 인스턴스 생성
1.  OCI 콘솔 내에서 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Oracle Databases > GoldenGate를 클릭합니다.
2. 화면 중간에 Create deployment 버튼을 클릭합니다.
3. 아래와 같이 정보를 입력합니다.
```
Name: OGG-Bigdata
Compartment: 생성하고자 하는 컴파트먼트 선택
Type: Development or testing
Subnet: Public subnet
License type: BYOL / License included에서 선택
show advanced options > Enable GoldenGate console public access를 꼭!! 체크해 줍니다.
```
4. Next를 클릭한 후, 아래와 같이 정보 입력 후에 Create를 누릅니다.
```
Technology: Bigdata
Version: 최신버전 그대로 놔둡니다.
Instance Name: OGG-Bigdata
Administrator Username: ggadmin
Password Secret: 미리 생성해둔 Password Secret을 선택합니다.
```

<img width="1109" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/a34a0f00-ce1a-40ee-8828-5a7fd4ea1447">

### Connections 생성 및 할당
1. OCI 콘솔 내에 좌측 상단 <img width="36" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/e383f362-0489-4a58-ba72-4165b41bdd99"> (네비게이션 메뉴)를 클릭하고, Oracle Database > Goldengate를 클릭합니다.
2. 좌측 리스트 메뉴에서 Connections를 클릭합니다.

 <img width="1495" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/46585e3b-3a14-4500-beb4-0e43a6c730df">

3. Create connection 버튼을 클릭합니다. 아래의 정보를 입력합니다.
```
Name: TargetST
Compartment: OCI-GG생성한 동일 컴파트먼트 선택
Type: OCI Streaming
```

4. Next 버튼을 클릭합니다. select Stream pool 버튼을 클릭하여, 타겟 스트리밍 정보를 선택하고 아래와 같이 정보를 입력합니다. (아래 예시 사진을 참고하여 정확하게 입력하도록 합니다.)
```
Stream pool: DefaultPool (생성한 OCI Streaming 서비스가 포함되어 있는 Stream pool 이름을 선택합니다.)
Username: 위의 Credential 확인 부분에서 확인했던 Kafka connection Settings 내의 Username 값을 입력합니다.
Password: 위의 Credential 확인 부분에서 생성했던 AUTH TOKEN값을 입력합니다.
```

<img width="736" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/b2aad826-07e8-4805-b96a-5ecd3e2aae62">

5. Connection 생성이 완료 되었으면, Assigned depolyments 메뉴를 클릭한 후 오른쪽 Assign deployment 버튼을 클릭하여 OGG-Bigdata 인스턴스에 할당합니다.

<img width="1155" alt="image" src="https://github.com/oraclekr-data-platform/ODWS-S02-Data-Replication/assets/150218254/93b1aaca-cd45-4e8f-ab51-ee77d825ebd1">
